<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example 1. How to open and visualise Copernicus Marine Data in R • ncdfCF</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example 1. How to open and visualise Copernicus Marine Data in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ncdfCF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/ncdfCF.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/31_Creating.html">1. Creating new data sets and variables</a></li>
    <li><a class="dropdown-item" href="../articles/32_R-CF.html">2. R and CF Metadata Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/91_CMEMS.html">Example 1. How to open and visualise Copernicus Marine Data in R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-CF/ncdfCF/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example 1. How to open and visualise Copernicus Marine Data in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-CF/ncdfCF/blob/HEAD/vignettes/articles/91_CMEMS.Rmd" class="external-link"><code>vignettes/articles/91_CMEMS.Rmd</code></a></small>
      <div class="d-none name"><code>91_CMEMS.Rmd</code></div>
    </div>

    
    
<p>The Copernicus Marine Service has a <a href="https://help.marine.copernicus.eu/en/articles/5040824-how-to-open-and-visualize-copernicus-marine-data-in-r" class="external-link">page</a>
that demonstrates how to open and visualise Copernicus marine data in
<code>R</code> using the <code>ncdf4</code> package. This page shows how
to get the same results - and more - using the <code>ncdfCF</code>
package.</p>
<div class="section level2">
<h2 id="main-packages">Main packages<a class="anchor" aria-label="anchor" href="#main-packages"></a>
</h2>
<p>This example uses the <code>ncdfCF</code> package to access and
interpret the marine data. For visualisation some optional packages are
loaded later on.</p>
</div>
<div class="section level2">
<h2 id="open-netcdf-files-and-load-the-data">Open netCDF files and load the data<a class="anchor" aria-label="anchor" href="#open-netcdf-files-and-load-the-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open the netCDF file</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-CF/ncdfCF" class="external-link">ncdfCF</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/open_ncdf.html">open_ncdf</a></span><span class="op">(</span><span class="st">"../../tests/testdata/cmems_mod_med_phy-tem_anfc_4.2km_P1M-m_1748594717636.nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lat' found in variable 'bottomT'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lon' found in variable 'bottomT'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lat' found in variable 'thetao'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lon' found in variable 'thetao'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lat' found in variable 'bottomT'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lon' found in variable 'bottomT'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lat' found in variable 'thetao'.</span></span>
<span><span class="co">#&gt; Warning: Unmatched `coordinates` value 'lon' found in variable 'thetao'.</span></span>
<span><span class="co">#&gt; &lt;Dataset&gt; cmems_mod_med_phy-tem_anfc_4.2km_P1M-m_1748594717636 </span></span>
<span><span class="co">#&gt; Resource   : ../../tests/testdata/cmems_mod_med_phy-tem_anfc_4.2km_P1M-m_1748594717636.nc </span></span>
<span><span class="co">#&gt; Format     : netcdf4 </span></span>
<span><span class="co">#&gt; Collection : Generic netCDF data </span></span>
<span><span class="co">#&gt; Conventions: CF-1.11 </span></span>
<span><span class="co">#&gt; Has groups : FALSE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables:</span></span>
<span><span class="co">#&gt;  name    long_name                       units     data_type</span></span>
<span><span class="co">#&gt;  bottomT Sea floor potential temperature degrees_C NC_FLOAT </span></span>
<span><span class="co">#&gt;  thetao  Sea temperature                 degrees_C NC_FLOAT </span></span>
<span><span class="co">#&gt;  axes                            </span></span>
<span><span class="co">#&gt;  longitude, latitude, time       </span></span>
<span><span class="co">#&gt;  longitude, latitude, depth, time</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attributes:</span></span>
<span><span class="co">#&gt;  name             type      length</span></span>
<span><span class="co">#&gt;  Conventions      NC_STRING 1     </span></span>
<span><span class="co">#&gt;  title            NC_STRING 1     </span></span>
<span><span class="co">#&gt;  institution      NC_STRING 1     </span></span>
<span><span class="co">#&gt;  source           NC_STRING 1     </span></span>
<span><span class="co">#&gt;  contact          NC_STRING 1     </span></span>
<span><span class="co">#&gt;  references       NC_STRING 1     </span></span>
<span><span class="co">#&gt;  comment          NC_STRING 1     </span></span>
<span><span class="co">#&gt;  subset:source    NC_STRING 1     </span></span>
<span><span class="co">#&gt;  subset:productId NC_STRING 1     </span></span>
<span><span class="co">#&gt;  subset:datasetId NC_STRING 1     </span></span>
<span><span class="co">#&gt;  subset:date      NC_STRING 1     </span></span>
<span><span class="co">#&gt;  value                                             </span></span>
<span><span class="co">#&gt;  CF-1.11                                           </span></span>
<span><span class="co">#&gt;  Sea Temperature (3D) - Monthly Mean               </span></span>
<span><span class="co">#&gt;  Centro Euro-Mediterraneo sui Cambiamenti Climat...</span></span>
<span><span class="co">#&gt;  MedFS EAS9                                        </span></span>
<span><span class="co">#&gt;  servicedesk.cmems@mercator-ocean.eu               </span></span>
<span><span class="co">#&gt;  Please check in CMEMS catalogue the INFO sectio...</span></span>
<span><span class="co">#&gt;  Please check in CMEMS catalogue the INFO sectio...</span></span>
<span><span class="co">#&gt;  ARCO data downloaded from the Marine Data Store...</span></span>
<span><span class="co">#&gt;  MEDSEA_ANALYSISFORECAST_PHY_006_013               </span></span>
<span><span class="co">#&gt;  cmems_mod_med_phy-tem_anfc_4.2km_P1M-m_202411     </span></span>
<span><span class="co">#&gt;  2025-05-30T08:45:17.637Z</span></span></code></pre></div>
<p>All overall information about the file is listed:</p>
<ul>
<li><p>Variables: <code>bottomT</code> and <code>thetao</code>, with 3
and 4 axes, respectively.</p></li>
<li><p>Global attributes: title, source, references, etc.</p></li>
</ul>
<p>Also important is the global attribute <code>Conventions</code>,
which tells us that this netCDF file is encoded using the CF-1.11
metadata conventions. The <code>ncdfCF</code> package uses this to
interpret all the information in the file that give the variables
“meaning”, such as their axes, units, time coordinates, etc.</p>
<p>(Please note that the warnings at the top are generated because there
is an error in the definition of the “coordinates” attribute of the data
variables. That has no negative effect on using this file. Further down
you’ll see what caused these warnings to be generated.)</p>
</div>
<div class="section level2">
<h2 id="get-an-ocean-variable">Get an ocean variable<a class="anchor" aria-label="anchor" href="#get-an-ocean-variable"></a>
</h2>
<p>There are two variables in the data set: <code>bottomT</code> and
<code>thetao.</code> We’ll work here with <code>thetao</code>: Sea
temperature.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign the theta data variable</span></span>
<span><span class="op">(</span><span class="va">thetao</span> <span class="op">&lt;-</span> <span class="va">ds</span><span class="op">[[</span><span class="st">"thetao"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;Variable&gt; thetao </span></span>
<span><span class="co">#&gt; Long name: Sea temperature </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Values: (not loaded)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Axes:</span></span>
<span><span class="co">#&gt;  axis name      long_name length values                     </span></span>
<span><span class="co">#&gt;  X    longitude Longitude 282    [7.750002 ... 19.458336]   </span></span>
<span><span class="co">#&gt;  Y    latitude  Latitude  256    [35.354168 ... 45.979168]  </span></span>
<span><span class="co">#&gt;  Z    depth     Depth     141    [1.018237 ... 5754.043945] </span></span>
<span><span class="co">#&gt;  T    time      Time       12    [2024-01-01 ... 2024-12-01]</span></span>
<span><span class="co">#&gt;  unit                             </span></span>
<span><span class="co">#&gt;  degrees_east                     </span></span>
<span><span class="co">#&gt;  degrees_north                    </span></span>
<span><span class="co">#&gt;  m                                </span></span>
<span><span class="co">#&gt;  seconds since 1970-01-01 00:00:00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attributes:</span></span>
<span><span class="co">#&gt;  name          type      length value                         </span></span>
<span><span class="co">#&gt;  units         NC_STRING 1      degrees_C                     </span></span>
<span><span class="co">#&gt;  standard_name NC_STRING 1      sea_water_potential_tempera...</span></span>
<span><span class="co">#&gt;  long_name     NC_STRING 1      Sea temperature               </span></span>
<span><span class="co">#&gt;  valid_max     NC_FLOAT  1      40                            </span></span>
<span><span class="co">#&gt;  valid_min     NC_FLOAT  1      1</span></span></code></pre></div>
<p>(Coming back to the warnings at the beginning: The “coordinates”
attribute has the value “time depth lat lon”. If you look at the axes,
however, you can see that the first two are called “longitude” and
“latitude”, rather than their short versions “lon” and “lat”: a warning
will be generated.)</p>
<p>From looking at the properties of the data set we already knew that
data variable thetao has 4 axes. Now that we drill down to the details
of the data variable you can see the range of values and their physical
unit. You can also inspect the coordinates along the axes quite
easily:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The "time" coordinates</span></span>
<span><span class="va">thetao</span><span class="op">$</span><span class="va">axes</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinates</span></span>
<span><span class="co">#&gt;  [1] "2024-01-01" "2024-02-01" "2024-03-01" "2024-04-01" "2024-05-01"</span></span>
<span><span class="co">#&gt;  [6] "2024-06-01" "2024-07-01" "2024-08-01" "2024-09-01" "2024-10-01"</span></span>
<span><span class="co">#&gt; [11] "2024-11-01" "2024-12-01"</span></span>
<span></span>
<span><span class="co"># The "depth" coordinates</span></span>
<span><span class="va">thetao</span><span class="op">$</span><span class="va">axes</span><span class="op">[[</span><span class="st">"depth"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinates</span></span>
<span><span class="co">#&gt;   [1]    1.018237    3.165747    5.464963    7.920377   10.536604   13.318384</span></span>
<span><span class="co">#&gt;   [7]   16.270586   19.398211   22.706392   26.200399   29.885643   33.767673</span></span>
<span><span class="co">#&gt;  [13]   37.852192   42.145039   46.652210   51.379860   56.334286   61.521957</span></span>
<span><span class="co">#&gt;  [19]   66.949493   72.623688   78.551498   84.740044   91.196632   97.928726</span></span>
<span><span class="co">#&gt;  [25]  104.943977  112.250206  119.855431  127.767838  135.995804  144.547897</span></span>
<span><span class="co">#&gt;  [31]  153.432846  162.659622  172.237350  182.175354  192.483139  203.170441</span></span>
<span><span class="co">#&gt;  [37]  214.247162  225.723404  237.609467  249.915848  262.653229  275.832520</span></span>
<span><span class="co">#&gt;  [43]  289.464783  303.561310  318.133545  333.193146  348.751953  364.821960</span></span>
<span><span class="co">#&gt;  [49]  381.415436  398.544708  416.222321  434.461060  453.273773  472.673492</span></span>
<span><span class="co">#&gt;  [55]  492.673462  513.286987  534.527588  556.408875  578.944580  602.148621</span></span>
<span><span class="co">#&gt;  [61]  626.034912  650.617554  675.910706  701.928650  728.685608  756.196045</span></span>
<span><span class="co">#&gt;  [67]  784.474304  813.534851  843.392151  874.060669  905.554810  937.889099</span></span>
<span><span class="co">#&gt;  [73]  971.077881 1005.135498 1040.076294 1075.914307 1112.663696 1150.338379</span></span>
<span><span class="co">#&gt;  [79] 1188.952148 1228.518799 1269.051758 1310.564209 1353.069336 1396.579956</span></span>
<span><span class="co">#&gt;  [85] 1441.108643 1486.667847 1533.269409 1580.925171 1629.646606 1679.444824</span></span>
<span><span class="co">#&gt;  [91] 1730.330322 1782.313599 1835.404541 1889.612671 1944.947144 2001.416626</span></span>
<span><span class="co">#&gt;  [97] 2059.029053 2117.792480 2177.714111 2238.800293 2301.057617 2364.491699</span></span>
<span><span class="co">#&gt; [103] 2429.107666 2494.910156 2561.903076 2630.089844 2699.473633 2770.056641</span></span>
<span><span class="co">#&gt; [109] 2841.840820 2914.826904 2989.015869 3064.407471 3141.001465 3218.796143</span></span>
<span><span class="co">#&gt; [115] 3297.790283 3377.981445 3459.366211 3541.941895 3625.703857 3710.647461</span></span>
<span><span class="co">#&gt; [121] 3796.768066 3884.059570 3972.516113 4062.130371 4152.895996 4244.804199</span></span>
<span><span class="co">#&gt; [127] 4337.847656 4432.017578 4527.304199 4623.698730 4721.191406 4819.770996</span></span>
<span><span class="co">#&gt; [133] 4919.427246 5020.149414 5121.925781 5224.744629 5328.593750 5433.460938</span></span>
<span><span class="co">#&gt; [139] 5539.333496 5646.199219 5754.043945</span></span></code></pre></div>
<p>The <code>thetao</code> data variable has 12 months along its “time”
axis and 141 “depth” values. Let’s look at the temperature at the
surface. The first coordinate value is 1.018237m below the surface but
it actually represents the surface layer. We can extract this data using
the <code>$subset()</code> method of the data variable, using a margin
around the value:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">surfaceT</span> <span class="op">&lt;-</span> <span class="va">thetao</span><span class="op">$</span><span class="fu">subset</span><span class="op">(</span>depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;Variable&gt; thetao </span></span>
<span><span class="co">#&gt; Long name: Sea temperature </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Values: (not loaded)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Axes:</span></span>
<span><span class="co">#&gt;  axis name      long_name length values                     </span></span>
<span><span class="co">#&gt;  X    longitude Longitude 282    [7.750002 ... 19.458336]   </span></span>
<span><span class="co">#&gt;  Y    latitude  Latitude  256    [35.354168 ... 45.979168]  </span></span>
<span><span class="co">#&gt;  Z    depth     Depth       1    [1.018237]                 </span></span>
<span><span class="co">#&gt;  T    time      Time       12    [2024-01-01 ... 2024-12-01]</span></span>
<span><span class="co">#&gt;  unit                             </span></span>
<span><span class="co">#&gt;  degrees_east                     </span></span>
<span><span class="co">#&gt;  degrees_north                    </span></span>
<span><span class="co">#&gt;  m                                </span></span>
<span><span class="co">#&gt;  seconds since 1970-01-01 00:00:00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attributes:</span></span>
<span><span class="co">#&gt;  name          type      length value                         </span></span>
<span><span class="co">#&gt;  units         NC_STRING 1      degrees_C                     </span></span>
<span><span class="co">#&gt;  standard_name NC_STRING 1      sea_water_potential_tempera...</span></span>
<span><span class="co">#&gt;  long_name     NC_STRING 1      Sea temperature               </span></span>
<span><span class="co">#&gt;  valid_max     NC_FLOAT  1      40                            </span></span>
<span><span class="co">#&gt;  valid_min     NC_FLOAT  1      1</span></span></code></pre></div>
<p>Note that there is only 1 “depth” value left. The axis is still there
so that you can look at its properties.</p>
</div>
<div class="section level2">
<h2 id="quick-map-plot">Quick map plot<a class="anchor" aria-label="anchor" href="#quick-map-plot"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the longitude and latitude coordinates</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="va">thetao</span><span class="op">$</span><span class="va">axes</span><span class="op">[[</span><span class="st">"longitude"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinates</span></span>
<span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="va">thetao</span><span class="op">$</span><span class="va">axes</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">coordinates</span></span>
<span></span>
<span><span class="co"># Make a map of the first time slice: January</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span>, <span class="va">surfaceT</span><span class="op">$</span><span class="fu">raw</span><span class="op">(</span><span class="op">)</span><span class="op">[</span>,,,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/flip.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="91_CMEMS_files/figure-html/image_plot-1.png" class="r-plt" alt="" width="700"></p>
<p>The <code>lattice</code> package’s <code><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot()</a></code> function
enables you to obtain a better map:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>lon<span class="op">=</span><span class="va">longitude</span>, lat<span class="op">=</span><span class="va">latitude</span><span class="op">)</span></span>
<span><span class="va">cutpts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">19</span>,<span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="va">surfaceT</span><span class="op">$</span><span class="fu">raw</span><span class="op">(</span><span class="op">)</span><span class="op">[</span>,,,<span class="fl">1</span><span class="op">]</span> <span class="op">~</span> <span class="va">lon</span> <span class="op">*</span> <span class="va">lat</span>,</span>
<span>          data<span class="op">=</span><span class="va">grid</span>, region<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>          pretty<span class="op">=</span><span class="cn">T</span>, at<span class="op">=</span><span class="va">cutpts</span>, cuts<span class="op">=</span><span class="fl">9</span>,</span>
<span>          col.regions<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/flip.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>,<span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, contour<span class="op">=</span><span class="fl">0</span>,</span>
<span>          xlab <span class="op">=</span> <span class="st">"Longitude"</span>, ylab <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"Sea Water Potential Temperature (°C)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="91_CMEMS_files/figure-html/lattice_plot-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="make-a-depth-profile-of-temperature">Make a depth profile of temperature<a class="anchor" aria-label="anchor" href="#make-a-depth-profile-of-temperature"></a>
</h2>
<p>You can make a temperature profile for a location and time (or a
transect) very easily. Here we get the temperate profile at increasing
depths for the month of July in the middle of the Tyrrhenian Sea, one of
the deeper parts of the Mediterranean.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a vertical profile of temperature at a single location for the month of July 2024</span></span>
<span><span class="va">tprof</span> <span class="op">&lt;-</span> <span class="va">thetao</span><span class="op">$</span><span class="fu">profile</span><span class="op">(</span>longitude <span class="op">=</span> <span class="fl">12.71</span>, latitude <span class="op">=</span> <span class="fl">40.33</span>, time <span class="op">=</span> <span class="st">"2024-07-01"</span>, .names <span class="op">=</span> <span class="st">"Tyrrhenian_Sea"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Turn the CFVariable object into a data.table</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="va">Tjuly</span> <span class="op">&lt;-</span> <span class="va">tprof</span><span class="op">$</span><span class="fu">data.table</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Tjuly</span><span class="op">)</span></span>
<span><span class="co">#&gt;    longitude latitude     depth       time Tyrrhenian_Sea</span></span>
<span><span class="co">#&gt;        &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;char&gt;          &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     12.71    40.33  1.018237 2024-07-01       27.12025</span></span>
<span><span class="co">#&gt; 2:     12.71    40.33  3.165747 2024-07-01       26.76333</span></span>
<span><span class="co">#&gt; 3:     12.71    40.33  5.464963 2024-07-01       26.37530</span></span>
<span><span class="co">#&gt; 4:     12.71    40.33  7.920377 2024-07-01       25.77510</span></span>
<span><span class="co">#&gt; 5:     12.71    40.33 10.536604 2024-07-01       24.80879</span></span>
<span><span class="co">#&gt; 6:     12.71    40.33 13.318384 2024-07-01       23.53961</span></span></code></pre></div>
<p>This table can be used for further analysis, but you can also make
very nice graph with the <code>ggplot2</code> package:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Tjuly</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">depth</span>, <span class="va">Tyrrhenian_Sea</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4000</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Depth (m)"</span>, y <span class="op">=</span> <span class="st">"Temperature (°C)"</span>, title <span class="op">=</span>  <span class="st">"Tyrrhenian Sea"</span>, subtitle <span class="op">=</span> <span class="st">"Location: 12.71E - 40.33N  Month: July 2024"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 22 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="91_CMEMS_files/figure-html/profile_plot-1.png" class="r-plt" alt="" width="700"></p>
<p>The temperature drops off very rapidly in the first 100m, then slowly
decreases to its lowest level at the bottom of the sea.</p>
<p>(The warning is harmless: Recall that the 141 depth values go down to
almost 6,000m. Here the seafloor is at about 3,600m and the remaining
depth values are set to NaN (not a number). These can obviously not be
plotted.)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Patrick Van Laake.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
